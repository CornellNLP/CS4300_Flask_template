<!-- Code references:
https://stackoverflow.com/questions/29738787/filling-water-animation/29740828#29740828
https://www.mkronenfeld.de/filling-liquid-animation/
https://stackoverflow.com/questions/24210132/remove-border-radius-from-select-tag-in-bootstrap-3/24766039
https://getbootstrap.com/docs/4.4/examples/cover/ -->

<!doctype html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <title>pick your poison</title>
      <link rel="stylesheet" href="/static/bootstrap.min.css">
      <link rel="stylesheet" href="/static/style.css">
      <script src="https://kit.fontawesome.com/3798c5de2c.js" crossorigin="anonymous"></script>  
   </head>
   <body>

      <!-- Wave Graphic -->
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" style="display: none;">
         <symbol id="wave">
            <path class="waveShape" d="M300 300V2.5s-.6-.1-1.1-.1c0 0-25.5-2.3-40.5-2.4-15 0-40.6 2.4-40.6 2.4-12.3 1.1-30.3 1.8-31.9 1.9-2-.1-19.7-.8-32-1.9 0 0-25.8-2.3-40.8-2.4-15 0-40.8 2.4-40.8 2.4-12.3 1.1-30.4 1.8-32 1.9-2-.1-20-.8-32.2-1.9 0 0-3.1-.3-8.1-.7V300h300z"/>
         </symbol>
      </svg>
      <div class="liquid">
         <svg viewBox="0 0 300 20" class="liquid__wave">
            <use xlink:href="#wave"></use>
         </svg>
      </div>

      <div class="cover-container d-flex w-100 h-100 mx-auto flex-column">

         <header class="masthead text-center">
            <div class="inner">
               <h3 class="masthead-brand"><a href="/">pick your poison</a></h3>
            </div>
         </header>

         <main role="main" class="inner cover">
            <p class="lead text-center">here's what we've picked for you</p><hr class="fancy mt-4 mb-5" />
            <div class="text-left text-dark results-list">
               {% for (drink, dist) in results %}
               <div class="card{% if loop.length == loop.index %} last{% endif %}">
                  <div class="card-header d-flex" id="heading{{ loop.index }}">
                     {% if drink.type == 'beer' %}
                        <i class="fas fa-beer fa-fw align-middle"></i>
                     {% elif drink.type == 'wine' %}
                        <i class="fas fa-wine-glass-alt fa-fw align-middle"></i>
                     {% elif drink.type == 'liquor' %}
                        <i class="fas fa-wine-bottle fa-fw align-middle"></i>
                     {% elif drink.type == 'cocktail' %}
                        <i class="fas fa-cocktail fa-fw align-middle"></i>
                     {% endif %}
                     <h2 class="mb-0 flex-grow-1">
                        <button class="btn btn-link text-left" type="button" data-toggle="collapse" data-target="#collapse{{ loop.index }}" aria-controls="collapse{{ loop.index }}">
                           <strong>{{ (page_number|int - 1) * 10 + loop.index }}.</strong> {{ drink.name }}
                        </button>
                     </h2>
                  </div>
               
                  <div id="collapse{{ loop.index }}" class="collapse" aria-labelledby="heading{{ loop.index }}">
                     {% if dist != [] %}<div class="tab-content">{% endif %}
                        {% if dist != [] %}<div id="info-{{ loop.index }}" class="tab-pane active show">{% endif %}
                           <div class="card-body text-dark{% if dist == [] %} no-reviews{% endif %}">
                              <h4>About this {{ drink.type }}</h4>
                              <p>{{ drink.description }}</p>
                              {% if drink.rating != None %}<p><strong>Rating:</strong> {{ drink.rating }}</p>{% endif %}
                              {% if drink.abv != None %}<p><strong>ABV:</strong> {{ drink.abv }}%</p>{% endif %}
                              {% if drink.price != None %}<p><strong>Price:</strong> ${{ drink.price }}</p>{% endif %}
                              {% if drink.origin != '' %}<p><strong>Origin:</strong> {{ drink.origin }}</p>{% endif %}
                              <a href="/?page=1&drink={{ drink.name }}" class="btn btn-outline-primary">Find similar drinks</a>
                              <a href="{{ drink.url }}" class="btn btn-outline-primary">Buy this {{ drink.type }}</a>
                           </div>
                        {% if dist != [] %}</div>{% endif %}
                        {% if dist != [] %}
                           <div id="reviews-{{ loop.index }}" class="tab-pane">
                              <div class="card-body text-dark reviews">
                                 <h4>Reviews</h4>
                                 {% for review in dist %}
                                    {% if review.body != None %}
                                       <blockquote class="blockquote">
                                          <p class="mb-0">{{ review.body }}</p>
                                          <footer class="blockquote-footer">Reviewed by <cite>{{ review.author }}</cite>{% if review.date != None %} on {{ review.date }}{% endif %} (Rating: {{ review.rating }})</footer>
                                       </blockquote>
                                    {% endif %}
                                 {% endfor %}
                                 <!-- <p>{{ dist }}</p> -->
                              </div>
                           </div>
                        {% endif %}
                     {% if dist != [] %}</div>{% endif %}
                     {% if dist != [] %}
                        <ul class="nav nav-tabs">
                           <li class="nav-item">
                              <a class="nav-link active" data-toggle="tab" href="#info-{{ loop.index }}">Information</a>
                           </li>
                           <li class="nav-item">
                              <a class="nav-link" data-toggle="tab" href="#reviews-{{ loop.index }}">Reviews</a>
                           </li>
                        </ul>
                     {% endif %}
                  </div>
               </div>
               {% endfor %}
            </div>
            <div class="text-center mt-5">
               <!-- TODO: remove previous button and implement infinite scrolling results -->
               {% if page_number|int > 1 %}
                  <a class="btn btn-lg btn-secondary mr-3" href="/?page={{ page_number|int - 1 }}{% if drink_name != None %}&drink={{ drink_name }}{% endif %}{% if drink_type != None %}&type={{ drink_type }}{% endif %}{% if base != None %}&base={{ base }}{% endif %}{% if descriptors != None %}&descriptors={{ descriptors }}{% endif %}{% if min_price != None %}&minprice={{ min_price }}{% endif %}{% if max_price != None %}&maxprice={{ max_price }}{% endif %}{% if min_abv != None %}&minabv={{ min_abv }}{% endif %}{% if max_abv != None %}&maxabv={{ max_abv }}{% endif %}">previous results</a>
               {% endif %}
               <a class="btn btn-lg btn-secondary" href="/?page={{ page_number|int + 1 }}{% if drink_name != None %}&drink={{ drink_name }}{% endif %}{% if drink_type != None %}&type={{ drink_type }}{% endif %}{% if base != None %}&base={{ base }}{% endif %}{% if descriptors != None %}&descriptors={{ descriptors }}{% endif %}{% if min_price != None %}&minprice={{ min_price }}{% endif %}{% if max_price != None %}&maxprice={{ max_price }}{% endif %}{% if min_abv != None %}&minabv={{ min_abv }}{% endif %}{% if max_abv != None %}&maxabv={{ max_abv }}{% endif %}">more results</a>
            </div>
         </main>

         <footer class="mastfoot text-center">
            <div class="inner">
               <p>created by Derek Cheng, Collin Montag, DB Lee, Dana Luong, and Ishneet Sachar</p>
            </div>
         </footer>

      </div>

      <script>
         const body = document.getElementsByTagName('body')[0];
         body.style.height = `100vh`;
         body.style.overflow = `hidden`;
         
         const liquidElement = document.getElementsByClassName('liquid')[0];
         const maxPercent = 100;
         var percent = 0;
         setTimeout(() => {
            body.style.height = `100%`;
            body.style.overflow = `visible`;
         }, 4000);
      </script>
   
      <!-- Bootstrap JS -->
      <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
      
   </body>
</html>
